---
- name: WhoAmI
  tags: ["whoami"]
  block: 
    - name: WhoAmI Container
      when: ENVIRONMENT == 'dev'
      community.docker.docker_container:
        name: whoami
        image: traefik/whoami:latest
        state: started
        restart_policy: unless-stopped
        networks:
          - name: traefik
        volumes:
          - /var/run/docker.sock:/var/run/docker.sock
        labels:
          traefik.enable: "true"
          traefik.http.routers.whoami.rule: "Host(`whoami.{{ FRONTEND_DOMAIN}}`)"
          traefik.http.routers.whoami.entrypoints: "websecure"
          traefik.http.services.whoami.loadbalancer.server.port: "80"